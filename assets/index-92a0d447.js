import{_ as le,a as p,u as ce,N as B,b as z,O as de,L as ue,B as fe,R as he,c as E,d as me}from"./vendor__react-7e907114.js";import{u as pe,J as V,t as ge,Z as se,K as ye,Y as _e,z as xe,X as Ie,a as be}from"./vendor__firebase-7839cf72.js";import{l as ve,m as De,B as S,n as ke,T as Z,R as Ce,o as Se,p as R,q as $,s as x,t as O,u as M,v as U,w as I,x as we,y as W,z as H,A as oe,P as Pe,D as b,E as Le,G as Ne,I as q,M as Me,H as X,J as ee,K as Y,N as Te,O as Fe,Q as ze,U as Ee,V as G,W as J,X as Ae,Y as Be,Z as je,$ as Re,a0 as $e,a1 as Oe,a2 as Ue,a3 as We,a4 as He,a5 as Ye,a6 as Ge,a7 as Je}from"./vendor-70b17e34.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const l of r.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&o(l)}).observe(document,{childList:!0,subtree:!0});function a(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(n){if(n.ep)return;n.ep=!0;const r=a(n);fetch(n.href,r)}})();const K=le,re=K.Fragment,e=K.jsx,i=K.jsxs,Ve={apiKey:"AIzaSyC2gYe75Qnno_rwBsWMNtuBqoC5hZrilFg",authDomain:"ap-tcl-smart-shopping-list.firebaseapp.com",projectId:"ap-tcl-smart-shopping-list",storageBucket:"ap-tcl-smart-shopping-list.appspot.com",messagingSenderId:"588431735651",appId:"1:588431735651:web:ac3dc2408ba9ef4a99b156"},Ze=ve(Ve),T=pe(Ze),Q=864e5,C=new Date;function ie(s){return new Date(Date.now()+s*Q)}function w(s,t){const a=s.getTime(),o=t.getTime();return Math.floor((o-a)/Q)}function qe(s,t){const a=s.dateNextPurchased.toDate(),o=t.dateNextPurchased.toDate(),n=w(C,a),r=w(C,o);return s.urgency==="inactive"&&t.urgency!=="inactive"?1:s.urgency!=="inactive"&&t.urgency==="inactive"?-1:n>r?1:n<r?-1:s.name.localeCompare(t.name)}function Ke(s){for(let t of s){const a=t.dateLastPurchased?t.dateLastPurchased.toDate():C,o=w(a,C),n=w(C,t.dateNextPurchased.toDate());t.urgency=n>=0&&n<=7?"soon":n>7&&n<21?"kind of soon":n>=21?"not soon":n<0&&o<60?"overdue":"inactive"}return s.sort(qe)}const Qe=p.useState,Xe=p.useEffect;function et(s,t){const[a,o]=Qe(()=>{const n=localStorage.getItem(t);return n||s});return Xe(()=>a==null?localStorage.removeItem(t):localStorage.setItem(t,a),[t,a]),[a,o]}function tt(s,t){const a=V(T,s);return ge(a,t)}async function at(s){const t=V(T,s);return!(await xe(t)).empty}function nt(s){return s.docs.map(t=>{const a=t.data();a.id=t.id;let o;if(!a.dateLastPurchased)o=!1;else{const n=a.dateLastPurchased.toDate();o=C-n<Q}return a.isDefaultChecked=o,a})}async function st(s,{itemName:t,daysUntilNextPurchase:a}){const o=V(T,s);await Ie(o,{dateCreated:new Date,dateLastPurchased:null,dateNextPurchased:ie(a),name:t,totalPurchases:0})}async function ot(s,t){const a=se(T,s,t),o=new Date,n=await(await ye(a)).data(),r=n.dateLastPurchased===null?o:n.dateLastPurchased.toDate(),l=n.dateNextPurchased.toDate(),c=n.totalPurchases+1,m=w(r,l),v=w(r,o),f=De(m,v,c),y=ie(f);await _e(a,{dateLastPurchased:o,dateNextPurchased:y,totalPurchases:c})}function rt(s,t){return be(se(T,s,t))}const A=p.useState;function it({listToken:s,data:t}){const{state:a}=ce(),o=a?.itemUserSearchedFor,[n,r]=A(o||""),[l,d]=A(7),[c,m]=A(!1),[v,f]=A(""),y=/[\s\W]|_+|s$/g;return e(re,{children:e(S,{display:"flex",justifyContent:"center",minHeight:"100vh",children:i(ke,{children:[e("h2",{children:"Add an item to your shopping list:"}),e(Z,{id:"item-name-input",label:"Item name",variant:"outlined",defaultValue:o||null,onChange:D=>r(D.target.value)}),i(Ce,{children:[e(Se,{children:"How soon will you buy this item?"}),e(R,{value:"soon",control:e($,{}),label:"Soon",onChange:()=>d(7),checked:l===7}),e(R,{value:"kind of soon",control:e($,{}),label:"Kind of soon",onChange:()=>d(14),checked:l===14}),e(R,{value:"not soon",control:e($,{}),label:"Not soon",onChange:()=>d(30),checked:l===30})]}),e(x,{type:"submit",variant:"contained",size:"large",onClick:async D=>{D.preventDefault();const k=n.toLowerCase().replace(y,"");if(k===""){f("Please enter an item name.");return}for(const g of t){const h=g.name,L=h.toLowerCase().replace(y,"");if(k===L){f(`The item '${h}' is already on your list.`);return}}try{await st(s,{itemName:n,daysUntilNextPurchase:l}),f(`${n} has been added to your list.`),m(!1)}catch{m(!0),f("")}},children:"Add item"}),c?e("p",{children:"Oh no, something went wrong."}):e("p",{children:v})]})})})}const lt="/assets/logo-bfff7e75.png",te=p.useState,ct=O.__esModule?O.default:O;function dt({setListToken:s}){const[t,a]=te(""),[o,n]=te(!1),r=M("(max-width:600px)");function l(){const c=we();s(c),n(!0)}async function d(c){c.preventDefault(),await at(t)?(s(t),n(!0)):ct({text:"Sorry, this list does not exist.",position:"center",gravity:"top",duration:3e3}).showToast()}return i(U,{direction:"column",justifyContent:"center",alignItems:"center",children:[e("img",{src:lt,alt:"logo",width:r?"200":"300"}),i(U,{gap:2,alignItems:"center",children:[e(I,{variant:"h1",marginBottom:1,children:"The list that knows when it's time to stock up!"}),e(I,{variant:"h2",children:"Create a new shopping list."}),e(x,{type:"button",variant:"contained",size:"large",sx:{fontSize:"2em",minWidth:"20ch"},onClick:l,children:"Create list"})]}),e(I,{variant:"h2",children:e("p",{children:" - or - "})}),e(S,{component:"form",onSubmit:d,sx:{width:"100%"},children:i(U,{gap:1,alignItems:"center",children:[e(I,{variant:"h2",children:"Join an existing list."}),e(Z,{type:"text",id:"tokenInput",label:"three word token",onChange:c=>a(c.target.value),inputProps:{sx:{fontSize:"2em",width:"20ch",maxWidth:"100dvw"}},sx:{"& .MuiInputLabel-root, fieldset":{fontSize:"2em"}}}),e(x,{variant:"contained",size:"large",type:"submit",sx:{fontSize:"2em",minWidth:"20ch"},children:"Join List"})]})}),o&&e(B,{to:"/list",replace:!0})]})}const ut=p.useState,ft=W.__esModule?W.default:W,ht=H.__esModule?H.default:H;function mt({listToken:s}){const[t,a]=ut(null),o=M("(prefers-color-scheme: dark)"),n=oe(),r=d=>{a(d.currentTarget)},l=()=>{a(null)};return e(Pe,{sx:{minHeight:"100dvh"},children:i(b,{maxWidth:"false",sx:{display:"flex",flexDirection:"column",maxWidth:"100%",minHeight:"100%",bgcolor:o?"inherit":n.palette.secondary.light},children:[e(b,{maxWidth:"xl",sx:{p:"0"},disableGutters:!0,children:e(Le,{position:"relative",sx:{backgroundColor:o?n.palette.primary.dark:n.palette.primary.main},children:e(b,{maxWidth:"xl",children:i(Ne,{disableGutters:!0,children:[e(ht,{sx:{mr:1},fontSize:"large"}),e(I,{variant:"h3",sx:{mr:2,flexGrow:1,fontFamily:"monospace",fontWeight:700,letterSpacing:".3rem",color:"inherit",textDecoration:"none"},children:"Smart Shopping List"}),s?i(S,{sx:{flexGrow:0,display:{xs:"flex",md:"none"}},children:[e(q,{size:"large","aria-label":"account of current user","aria-controls":"menu-appbar","aria-haspopup":"true",onClick:r,color:"inherit",children:e(ft,{})}),i(Me,{id:"menu-appbar",anchorEl:t,anchorOrigin:{vertical:"bottom",horizontal:"left"},keepMounted:!0,transformOrigin:{vertical:"top",horizontal:"left"},open:Boolean(t),onClose:l,sx:{display:{xs:"block",md:"none"}},children:[e(X,{onClick:l,children:e(z,{to:"/list",className:"Menu-nav-link",children:"List"})}),e(X,{onClick:l,children:e(z,{to:"/add-item",className:"Menu-nav-link",children:"Add Item"})})]})]}):e(S,{}),s?i(ee,{"aria-label":"breadcrumb",color:"white",separator:"",sx:{display:{xs:"none",md:"block"}},children:[e(z,{to:"/list",className:"Nav-link",children:"List"}),e(z,{to:"/add-item",className:"Nav-link",children:"Add Item"})]}):e(ee,{})]})})})}),e(b,{maxWidth:"xl",sx:{display:"flex",justifyContent:"center",pt:"25px",pb:"50px",mb:"25px",bgcolor:o?"inherit":"white"},children:e("main",{children:e(de,{})})})]})})}const pt=Y.__esModule?Y.default:Y;function gt({name:s,itemId:t,urgency:a,isDefaultChecked:o,setIsChecked:n,setCheckedItemId:r,onDeleteClick:l,item:d}){const c=oe(),m=M("(max-width:600px)"),f={soon:c.palette.secondary.dark,"kind of soon":c.palette.primary.dark,"not soon":c.palette.tertiary.dark,inactive:"black",overdue:"#7f0000"}[a],P=`Last Purchased: ${d.dateLastPurchased?D(d.dateLastPurchased):"N/A"} â€¢ Total Purchases: ${d.totalPurchases}`;function D(g){const h=g.toDate(),L=(1+h.getMonth()).toString().padStart(2,"0"),F=h.getDate().toString().padStart(2,"0"),j=h.getFullYear().toString().substring(2);return`${L}/${F}/${j}`}function k(g,h){n(g.target.checked),r(h)}return i(Te,{disablePadding:m?!0:null,sx:{"&":{display:"flex",justifyContent:"space-between"}},children:[i(b,{sx:{"&":{display:"flex",alignItems:"center",padding:"0",margin:"0",maxWidth:"50%"}},children:[e(Fe,{id:t,edge:"start",defaultChecked:o,tabIndex:-1,disableRipple:!0,inputProps:{"aria-labelledby":`checkbox-liist-label=${s}`},onClick:g=>{k(g,t)}}),e(ze,{id:t,primary:s,secondary:P,secondaryTypographyProps:{fontSize:m?"small":"medium"},primaryTypographyProps:{fontSize:m?"small":"medium"},sx:{"&":{marginLeft:"10px"}}})]}),e(Ee,{size:"small",label:a,sx:{"&":{backgroundColor:`${f}`,color:"white",width:"90px"}}}),e(q,{edge:"end","aria-label":"delete",onClick:()=>{l(d)},children:e(pt,{})})]})}const N=p.useState,yt=p.useEffect,_t=p.forwardRef,xt=G.__esModule?G.default:G,ae=J.__esModule?J.default:J,It=_t(function(t,a){return e(Ae,{direction:"up",ref:a,...t})});function bt({data:s,listToken:t}){const[a,o]=N(""),[n,r]=N(""),[l,d]=N(!1),[c,m]=N(""),[v,f]=N(!1),y=M("(max-width:600px)");yt(()=>{l&&ot(t,n)},[l,t,n]);const P=s.filter(u=>{if(a==="")return u;if(u.name.toLowerCase().includes(a.toLowerCase()))return u}),k=Ke(P).map(u=>e(gt,{name:u.name,isDefaultChecked:u.isDefaultChecked,itemId:u.id,urgency:u.urgency,setCheckedItemId:r,setIsChecked:d,onDeleteClick:L,item:u},u.id)),g=Boolean(!s.length),h=Boolean(!P.length);function L(u){m(u),f(!0)}function F(){f(!1)}function j(){rt(t,c.id),f(!1)}return i(S,{minHeight:"100vh",children:[g?i(S,{display:"flex",flexDirection:"column",children:[e(I,{variant:"h2",paddingTop:"75px",paddingBottom:"50px",children:"Your list is currently empty."}),e(x,{type:"button",variant:"contained",size:"large",href:"/add-item",startIcon:e(ae,{}),children:"Add first item"})]}):i(re,{children:[e(b,{sx:{width:"100%",display:"flex",justifyContent:"center"},children:e(Z,{id:"outlined-search",label:"Search for an item in your list",type:"search",size:y?"small":"medium",margin:"normal",color:"primary",error:h,helperText:h?"No items matching your search terms.":null,sx:{width:y?"100%":"500px",minWidth:"250px"},onChange:u=>o(u.target.value),InputProps:{endAdornment:e(Be,{position:"end",children:e(q,{"aria-label":"search icon",edge:"end",children:e(xt,{})})})}})}),i(je,{sx:{"&":{width:y?"80vw":"60vw",margin:"auto"}},children:[k,h&&e(b,{sx:{"&":{display:"flex",flexDirection:"column",alignItems:"center"}},children:e(ue,{to:"/add-item",state:{itemUserSearchedFor:a},style:{color:"inherit",textDecoration:"none"},children:e(x,{type:"button",variant:"contained",size:"large",startIcon:e(ae,{}),children:i(I,{children:["Add ",e("span",{id:"prospectiveItemName",children:a})," to your list?"]})})})})]})]}),i(Re,{open:v,TransitionComponent:It,keepMounted:!0,onClose:F,"aria-describedby":"confirm-delete-dialog-slide-description",children:[e($e,{children:"Delete this item from your list?"}),e(Oe,{children:i(Ue,{id:"confirm-delete-dialog-slide-description",children:["Are you sure you want to delete"," ",e("span",{id:"dialogItemName",children:c.name}),"? This will permanently remove the item and its purchase history from your list."]})}),i(We,{children:[e(x,{onClick:j,children:"Delete"}),e(x,{onClick:F,children:"Cancel"})]})]})]})}const ne={grey:{0:"#ffffff",10:"#fafafa",50:"#f7f8fa",100:"#eff0f2",200:"#e4e5e7",300:"#d3d4d6",400:"#afb0b2",500:"#8f8f91",600:"#676869",700:"#545456",800:"#333333",900:"#191919",1e3:"#000000"},primary:{50:"#ece7ff",100:"#cdc4fe",200:"#aa9cfe",300:"#8173ff",400:"#5954ff",500:"#0335ff",600:"#0032f8",700:"#002bf0",800:"#0026eb",900:"#001be6"},secondary:{50:"#fffee6",100:"#fefac0",200:"#fdf795",300:"#fcf267",400:"#f9ee3f",500:"#f6e900",600:"#ffdd03",700:"#ffc400",800:"#ffab00",900:"#ff7f00"}},vt={primary:{dark:"#5B7963",main:"#82AD8E",light:"#9BBDA4",contrastText:"#FFFFF0"},secondary:{dark:"#A99346",main:"#FFFFF0",light:"#F4DB83",contrastText:"#000000"},tertiary:{dark:"#19717B",main:"#25A2b1",light:"#50B4C0",contrastText:"#000000"},background:{default:ne.grey[900],alt:ne.grey[800]}},_="Roboto, sans-serif",Dt={fontFamily:_,fontSize:12,h1:{fontFamily:_,fontSize:40},h2:{fontFamily:_,fontSize:32},h3:{fontFamily:_,fontSize:24},h4:{fontFamily:_,fontSize:20},h5:{fontFamily:_,fontSize:16},h6:{fontFamily:_,fontSize:14}},kt=p.useMemo,Ct=({children:s})=>{const t=M("(prefers-color-scheme: dark)"),a=kt(()=>He(Ye({palette:{...vt,mode:t?"dark":"light"},typography:Dt})),[t]);return i(Ge,{theme:a,children:[e(Je,{}),s]})},St=p.useEffect,wt=p.useState;function Pt(){const[s,t]=wt([]),[a,o]=et(null,"tcl-shopping-list-token");return St(()=>{if(a)return tt(a,n=>{const r=nt(n);t(r)})},[a]),e(Ct,{children:e(fe,{children:e(he,{children:i(E,{path:"/",element:e(mt,{listToken:a}),children:[e(E,{path:"/",element:a?e(B,{to:"/list"}):e(dt,{setListToken:o})}),e(E,{path:"/list",element:a?e(bt,{data:s,listToken:a}):e(B,{to:"/"})}),e(E,{path:"/add-item",element:a?e(it,{data:s,listToken:a}):e(B,{to:"/"})})]})})})})}const Lt=me.createRoot,Nt=Lt(document.getElementById("root"));Nt.render(e(Pt,{}));
